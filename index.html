<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Digital Clock with Themes</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="theme-buttons">
    <button id="dark-theme-btn" type="button">ğŸŒ™ Dark</button>
    <button id="light-theme-btn" type="button">â˜€ï¸ Light</button>
    <button id="sound-toggle-btn" type="button" aria-pressed="false">ğŸ”‡ Sound: OFF</button>
    <label class="vol-label" for="volume">Vol</label>
    <input id="volume" type="range" min="0" max="100" value="35" />
  </div>

  <main class="clock-container">
    <div class="clock-box">
      <div class="clock" aria-label="Digital clock">
        <div class="flip-digit" id="hours">12</div>
        <div class="colon">:</div>
        <div class="flip-digit" id="minutes">00</div>
        <div class="colon">:</div>
        <div class="flip-digit" id="seconds">00</div>
        <div class="ampm" id="ampm">AM</div>
      </div>

      <canvas id="analogClock" aria-label="Analog clock" width="300" height="300"></canvas>
    </div>

    <section class="media-panel" aria-label="Space time-lapse video">
      <h2 class="media-title">Waves</h2>
      <p class="media-desc">
        Short looping video.
      </p>

      <div class="video-wrapper">
        <video id="clockVideo" preload="metadata">
          <source src="waves.mp4" type="video/mp4">
          Your browser does not support the video tag.
        </video>

        <div class="video-controls" aria-label="Video controls">
          <button id="video-play-pause" type="button">â–¶ Play</button>
          <button id="video-mute" type="button">ğŸ”ˆ Mute</button>
          <span class="time-label">
            <span id="video-current-time">0:00</span> /
            <span id="video-duration">0:00</span>
          </span>
          <input id="video-seek" type="range" min="0" max="100" value="0">
        </div>
      </div>
    </section>
  </main>

  <script src="canvas-clock.js" defer></script>
  <script src="audio-clock.js" defer></script>
  <script src="video-clock.js" defer></script>

  <script>
    function flipDigit(digitEl, newValue) {
      if (digitEl.textContent === newValue) return;
      digitEl.style.transform = 'rotateX(-90deg)';
      setTimeout(() => {
        digitEl.textContent = newValue;
        digitEl.style.transform = 'rotateX(0deg)';
      }, 250);
    }

    function updateClock() {
      const now = new Date();
      let hours = now.getHours();
      const minutes = now.getMinutes().toString().padStart(2, '0');
      const seconds = now.getSeconds().toString().padStart(2, '0');
      const ampm = hours >= 12 ? 'PM' : 'AM';
      hours = (hours % 12) || 12;
      hours = hours.toString().padStart(2, '0');

      flipDigit(document.getElementById('hours'), hours);
      flipDigit(document.getElementById('minutes'), minutes);
      flipDigit(document.getElementById('seconds'), seconds);
      document.getElementById('ampm').textContent = ampm;

      window.dispatchEvent(new CustomEvent('clock:tick', { detail: { now } }));
    }

    setInterval(updateClock, 1000);
    updateClock();

    const darkBtn = document.getElementById('dark-theme-btn');
    const lightBtn = document.getElementById('light-theme-btn');

    darkBtn.addEventListener('click', () => {
      document.body.classList.remove('light');
      document.body.classList.add('dark');
      window.dispatchEvent(new Event('theme:changed'));
    });

    lightBtn.addEventListener('click', () => {
      document.body.classList.remove('dark');
      document.body.classList.add('light');
      window.dispatchEvent(new Event('theme:changed'));
    });

    document.body.classList.add('light');
    window.dispatchEvent(new Event('theme:changed'));
  </script>
</body>
</html>
